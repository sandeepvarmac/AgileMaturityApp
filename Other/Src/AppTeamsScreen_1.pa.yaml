# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  AppTeamsScreen_1:
    Children:
      - cntr_DisabledTeamsScreen_1:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(0, 0, 0, 0.6)
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =varShowNewTeamDialog
            Width: =Parent.Width
          Children:
            - cntr_NewTeamModal_1:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  Fill: =Color.White
                  Height: =Parent.Height*80%
                  LayoutDirection: =LayoutDirection.Vertical
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowNewTeamDialog
                Children:
                  - cntr_NewTeamModelHeader_1:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        Height: =70
                        LayoutDirection: =LayoutDirection.Horizontal
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                      Children:
                        - lbl_NewTeamModalTitle_1:
                            Control: Label@2.5.1
                            Properties:
                              FontWeight: =FontWeight.Semibold
                              PaddingLeft: =30
                              Size: =15
                              Text: ="Add New Team"
                              Width: =450
                        - Icon1_1:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              Color: =Color.DarkGray
                              Height: =40
                              Icon: =Icon.Cancel
                              OnSelect: =Set(varShowNewTeamDialog, false);
                              Width: =32
                              X: =388
                              Y: =8
                  - cntr_NewTeamModalBody_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Children:
                        - lbl_NewTeamTitle_1:
                            Control: Label@2.5.1
                            Properties:
                              PaddingLeft: =6
                              Size: =15
                              Text: ="Team Name*"
                              X: =28
                              Y: =52
                        - txt_NewTeamInputName_1:
                            Control: TextInput@0.0.54
                            Properties:
                              BorderColor: =RGBA(230, 230, 230, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              Fill: =RGBA(255, 255, 255, 1)
                              Font: =Font.'Open Sans'
                              FontSize: =20
                              Height: =48
                              Width: =436
                              X: =35
                              Y: =92
                        - lbl_NewTeamVerticalTitle_1:
                            Control: Label@2.5.1
                            Properties:
                              PaddingLeft: =6
                              Size: =15
                              Text: ="Vertical*"
                              X: =28
                              Y: =175
                        - drpdwn_NewTeamVertical_1:
                            Control: DropDown@0.0.45
                            Properties:
                              Appearance: ='DropdownCanvas.Appearance'.Outline
                              BorderColor: =RGBA(230, 230, 230, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              FontSize: =20
                              Height: =48
                              Items: =Verticals
                              Width: =436
                              X: =35
                              Y: =215
                            Children:
                              - Title2_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Title"
                                    FieldName: ="Title"
                                    FieldType: ="s"
                                    Order: =1
                              - TeamName1_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="TeamName"
                                    FieldName: ="TeamName"
                                    FieldType: ="s"
                                    Order: =2
                              - ScrumMaster1_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="ScrumMaster"
                                    FieldName: ="ScrumMaster"
                                    FieldType: ="E"
                                    Order: =3
                              - Status1_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Status"
                                    FieldName: ="Status"
                                    FieldType: ="E"
                                    Order: =4
                              - Vertical1_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Vertical"
                                    FieldName: ="Vertical"
                                    FieldType: ="E"
                                    Order: =5
                              - Attachments2_1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Attachments"
                                    FieldName: ="{Attachments}"
                                    FieldType: ="r*"
                                    Order: =6
                        - lbl_NewTeamSMTitle_1:
                            Control: Label@2.5.1
                            Properties:
                              PaddingLeft: =6
                              Size: =15
                              Text: ="Scrum Master"
                              X: =28
                              Y: =310
                        - txt_NewTeamSMName_1:
                            Control: TextInput@0.0.54
                            Properties:
                              BorderRadius: =10
                              Font: =Font.'Open Sans'
                              FontColor: =Color.DarkGray
                              FontSize: =20
                              FontWeight: =FontWeight.Normal
                              Height: =48
                              Value: =User().FullName
                              Width: =436
                              X: =35
                              Y: =350
                  - cntr_NewTeamModalFooter_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Height: =100
                      Children:
                        - btn_NewTeamCancel_1:
                            Control: Button@0.0.45
                            Properties:
                              Appearance: ='ButtonCanvas.Appearance'.Secondary
                              BasePaletteColor: =RGBA(0, 130, 101, 1)
                              Font: =Font.'Open Sans'
                              FontSize: =15
                              Height: =40
                              IconStyle: ='ButtonCanvas.IconStyle'.Filled
                              OnSelect: =Set(varShowNewTeamDialog, false);
                              Text: ="Cancel"
                              X: =254
                              Y: =28
                        - btn_NewTeamSubmit_1:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(0, 130, 101, 1)
                              Font: =Font.'Open Sans'
                              FontSize: =15
                              FontWeight: =FontWeight.Semibold
                              Height: =40
                              OnSelect: |+
                                =If(
                                    IsBlank(txt_NewTeamInputName_1.Value) || IsBlank(drpdwn_NewTeamVertical_1.Selected.ID),
                                    // Validation failed
                                    Notify(
                                        "Please enter Team Name and select a Vertical",
                                        NotificationType.Warning
                                    ),
                                    // Validation passed, submit data
                                    Patch(
                                        'Teams',
                                        Defaults('Teams'),
                                        {
                                            Title: txt_NewTeamInputName_1.Value,
                                            TeamName: txt_NewTeamInputName_1.Value,
                                            ScrumMaster: txt_NewTeamSMName_1.Value,
                                            Status: {
                                                '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                                                Value: "Active"
                                            },
                                            Vertical: {
                                            '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                                            Id: drpdwn_NewTeamVertical_1.Selected.ID,
                                            Value: drpdwn_NewTeamVertical_1.Selected.Title
                                        }

                                        }
                                    );
                                    // Hide modal and refresh teams
                                Set(
                                        varShowNewTeamDialog,
                                        false
                                    );
                                    Notify(
                                        "Team successfully created",
                                        NotificationType.Success
                                    )
                                )



                              Text: ="Submit"
                              X: =372
                              Y: =28
      - cntr_TeamsBody_1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =App.Height - GlobalHeaderSidePanelFooter_7.cntr_globalHeaderHeight
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =App.Width - GlobalHeaderSidePanelFooter_7.cntr_globalNavBarWidth
            X: =GlobalHeaderSidePanelFooter_7.cntr_globalNavBarWidth
            Y: =GlobalHeaderSidePanelFooter_7.cntr_globalHeaderHeight
          Children:
            - btn_NewTeam_1:
                Control: Button@0.0.45
                Properties:
                  Appearance: ='ButtonCanvas.Appearance'.Primary
                  BasePaletteColor: =RGBA(0, 130, 101, 1)
                  Font: =Font.'Segoe UI'
                  FontSize: =20
                  Height: =48
                  Icon: ="Add"
                  IconStyle: ='ButtonCanvas.IconStyle'.Filled
                  Layout: ='ButtonCanvas.Layout'.IconBefore
                  OnSelect: |-
                    =Set(varShowNewTeamDialog, true);
                    Reset(txt_NewTeamInputName_1);
                    Reset(drpdwn_NewTeamVertical_1);
                  Text: ="New Team"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =236
                  X: =824
                  Y: =24
            - Label1_1:
                Control: Label@2.5.1
                Properties:
                  Text: =varShowNewTeamDialog
                  X: =40
                  Y: =40
            - Gallery3_1:
                Control: Gallery@2.15.0
                Variant: Horizontal
                Properties:
                  Height: =481
                  Items: =Teams
                  TemplatePadding: =20
                  TemplateSize: =510
                  Width: =1094
                  WrapCount: =2
                  Y: =96
                Children:
                  - Container7_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderColor: =RGBA(230, 230, 230, 1)
                        BorderThickness: =1
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =510
                      Children:
                        - Label2_2:
                            Control: Label@2.5.1
                            Properties:
                              FontWeight: =FontWeight.Semibold
                              Size: =15
                              Text: =ThisItem.TeamName
                              X: =24
                              Y: =16
                        - Label2_3:
                            Control: Label@2.5.1
                            Properties:
                              DisabledColor: =RGBA(191, 191, 191, 1)
                              Height: =37
                              Text: =ThisItem.Vertical.Value
                              Width: =216
                              X: =24
                              Y: =56
                        - ButtonCanvas7_1:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(0, 130, 101, 1)
                              Font: =Font.'Open Sans'
                              FontSize: =16
                              Height: =39
                              Text: ="Assess Team"
                              Width: =461
                              X: =24
                              Y: =143
      - GlobalHeaderSidePanelFooter_7:
          Control: CanvasComponent
          ComponentName: GlobalHeaderSidePanelFooter
          Properties:
            Height: =768
            Width: =1366
