AppReportsScreen As screen:
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: =Set(gblAssessView, If(gblIsAdmin, Assessments, Filter(Assessments, TeamLookup.Value in Filter(Teams, ScrumMaster = User().FullName).TeamName)))
 =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary

    GlobalHeaderSidePanelFooter_4 As GlobalHeaderSidePanelFooter:

    // Quick Filters
    cntr_FilterBar As groupContainer.horizontalAutoLayoutContainer:
        Height: =60
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Horizontal
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingLeft: =20
        PaddingRight: =20
        Width: =App.Width - GlobalHeaderSidePanelFooter_4.cntr_globalNavBarWidth
        X: =GlobalHeaderSidePanelFooter_4.cntr_globalNavBarWidth
        Y: =GlobalHeaderSidePanelFooter_4.cntr_globalHeaderHeight
        ZIndex: =1

        Label_Filter_Vertical As label:
            Color: =RGBA(137, 137, 137, 1)
            Font: =App.Theme.Font
            Size: =12
            Text: ="Vertical"
            Width: =80
            ZIndex: =1

        drp_ReportVertical As Dropdown.pcfdataset:
            Appearance: ='DropdownCanvas.Appearance'.FilledLighter
            BorderRadius: =8
            DefaultSelectedItems: =[
                { Value: "All" }
            ]
            DisplayMode: =DisplayMode.Edit
            Height: =36
            Items: =
                With(
                    { verts: SortByColumns(Distinct(Assessments, Vertical.Value), "Result") },
                    Table({Value: "All"}) & AddColumns(verts, "Value", Result)
                )
            Width: =220
            ZIndex: =2

        Label_Filter_Gran As label:
            Color: =RGBA(137, 137, 137, 1)
            Font: =App.Theme.Font
            Size: =12
            Text: ="Granularity"
            Width: =90
            ZIndex: =3

        drp_Granularity As Dropdown.pcfdataset:
            Appearance: ='DropdownCanvas.Appearance'.FilledLighter
            BorderRadius: =8
            DefaultSelectedItems: =[{ Value: "Quarterly" }]
            Items: =Table({Value: "Monthly"}, {Value: "Quarterly"})
            Width: =160
            ZIndex: =4

        Label_Filter_Year As label:
            Color: =RGBA(137, 137, 137, 1)
            Font: =App.Theme.Font
            Size: =12
            Text: ="Year"
            Width: =60
            ZIndex: =5

        drp_Year As Dropdown.pcfdataset:
            Appearance: ='DropdownCanvas.Appearance'.FilledLighter
            BorderRadius: =8
            DefaultSelectedItems: =[
                { Value: Year(Today()) }
            ]
            Items: =Sort(Table(ForAll(Distinct(Assessments, Year(AssessmentDate)), { Value: Result })), Value)
            Width: =120
            ZIndex: =6

    cntr_ReportsBody As groupContainer.manualLayoutContainer:
        BorderColor: =RGBA(230, 230, 230, 1)
        BorderThickness: =1
        Height: =App.Height - GlobalHeaderSidePanelFooter_4.cntr_globalHeaderHeight - cntr_FilterBar.Height
        Width: =App.Width - GlobalHeaderSidePanelFooter_4.cntr_globalNavBarWidth
        X: =GlobalHeaderSidePanelFooter_4.cntr_globalNavBarWidth
        Y: =GlobalHeaderSidePanelFooter_4.cntr_globalHeaderHeight + cntr_FilterBar.Height
        ZIndex: =2

        cntr_KPIRow As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            BorderColor: =RGBA(230, 230, 230, 1)
            FillPortions: =0
            Height: =140
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =20
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =20
            Width: =Parent.Width - 40
            X: =20
            Y: =20
            ZIndex: =1

            kpi_Total As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                Height: =100
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =2

                lbl_Total_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Total Assessments"
                    ZIndex: =1

                lbl_Total_Value As label:
                    Color: =RGBA(0, 0, 0, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Bold
                    PaddingLeft: =12
                    Size: =28
                    Text: =With(
                        { assessFiltered: Filter(
                            gblAssessView,
                            (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                            (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value)
                          ) },
                        CountRows(assessFiltered)
                    )
                    ZIndex: =2

            kpi_Completed As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                Height: =100
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =3

                lbl_Completed_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Completed"
                    ZIndex: =1

                lbl_Completed_Value As label:
                    Color: =RGBA(0, 0, 0, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Bold
                    PaddingLeft: =12
                    Size: =28
                    Text: =With(
                        { assessFiltered: Filter(
                            gblAssessView,
                            (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                            (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                            'Status '.Value = "Completed"
                          ) },
                        CountRows(assessFiltered)
                    )
                    ZIndex: =2

            kpi_InProgress As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                Height: =100
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =4

                lbl_InProgress_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="In Progress"
                    ZIndex: =1

                lbl_InProgress_Value As label:
                    Color: =RGBA(0, 0, 0, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Bold
                    PaddingLeft: =12
                    Size: =28
                    Text: =With(
                        { assessFiltered: Filter(
                            gblAssessView,
                            (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                            (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                            'Status '.Value = "In Progress"
                          ) },
                        CountRows(assessFiltered)
                    )
                    ZIndex: =2

            kpi_AvgScore As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                Height: =100
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =5

                lbl_AvgScore_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Average Score (Completed)"
                    ZIndex: =1

                lbl_AvgScore_Value As label:
                    Color: =RGBA(0, 0, 0, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Bold
                    PaddingLeft: =12
                    Size: =28
                    Text: =With(
                        { completed: Filter(
                            gblAssessView,
                            (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                            (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                            'Status '.Value = "Completed" && !IsBlank(OverallScore)
                          ) },
                        If(CountRows(completed)>0, Text(Average(completed, OverallScore), "0.0"), "-")
                    )
                    ZIndex: =2

        cntr_BreakdownRow As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            FillPortions: =0
            Height: =Parent.Height - cntr_KPIRow.Height - 80
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =20
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =10
            Width: =Parent.Width - 40
            X: =20
            Y: =cntr_KPIRow.Y + cntr_KPIRow.Height + 10
            ZIndex: =3

            cntr_ByTeam As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =1

                lbl_ByTeam_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Average Score by Team (Completed)"
                    ZIndex: =1

                glry_ByTeam As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =
                        With(
                            { completed: Filter(
                                gblAssessView,
                                (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                                (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                                'Status '.Value = "Completed" && !IsBlank(OverallScore)
                              ) },
                            SortByColumns(
                                AddColumns(
                                    GroupBy(
                                        AddColumns(completed, "TeamName", TeamLookup.Value),
                                        "TeamName",
                                        "Rows"
                                    ),
                                    "AvgScore", Average(Rows, OverallScore),
                                    "Count", CountRows(Rows)
                                ),
                                "AvgScore",
                                Descending
                            )
                        )
                    Layout: =Layout.Vertical
                    TemplateSize: =48
                    ZIndex: =2

                    lbl_TeamName As label:
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        Text: =Coalesce(ThisItem.TeamName, "â€”")
                        Width: =Parent.Width - 120
                        X: =12
                        Y: =8
                        ZIndex: =1

                    lbl_TeamAvg As label:
                        Align: =Align.Right
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Bold
                        Size: =14
                        Text: =If(!IsBlank(ThisItem.AvgScore), Text(ThisItem.AvgScore, "0.0"), "-") & "  (" & Text(ThisItem.Count) & ")"
                        Width: =100
                        X: =Parent.Width - 112
                        Y: =8
                        ZIndex: =2

            cntr_ByDimension As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =2

                lbl_ByDimension_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Average Score by Dimension (Completed)"
                    ZIndex: =1

                glry_ByDimension As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =
                        With(
                            { assessSet: Filter(
                                gblAssessView,
                                (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                                (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                                'Status '.Value = "Completed"
                              ) },
                            SortByColumns(
                                AddColumns(
                                    Dimensions,
                                    "AvgScore",
                                    With(
                                        { dimId: DimensionID },
                                        With(
                                            { stmts: Filter(Statements, DimensionLookup.Value = Text(dimId)) },
                                            With(
                                                {
                                                    ratings: Filter(
                                                        AssessmentRatings,
                                                        Rating > 0 &&
                                                        !IsBlank(LookUp(assessSet, ID = AssessmentLookup.Id).ID) &&
                                                        !IsBlank(LookUp(stmts, ID = StatementLookup.Id).ID)
                                                    )
                                                },
                                                If(CountRows(ratings) > 0, Average(ratings, Rating), Blank())
                                            )
                                        )
                                    ),
                                    "Count",
                                    With(
                                        { dimId2: DimensionID },
                                        With(
                                            { stmts2: Filter(Statements, DimensionLookup.Value = Text(dimId2)) },
                                            CountRows(
                                                Filter(
                                                    AssessmentRatings,
                                                    Rating > 0 &&
                                                    !IsBlank(LookUp(assessSet, ID = AssessmentLookup.Id).ID) &&
                                                    !IsBlank(LookUp(stmts2, ID = StatementLookup.Id).ID)
                                                )
                                            )
                                        )
                                    )
                                ),
                                "AvgScore",
                                Descending
                            )
                        )
                    Layout: =Layout.Vertical
                    TemplateSize: =48
                    ZIndex: =2

                    lbl_DimensionName As label:
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        Text: =Coalesce(ThisItem.DimensionName, ThisItem.Title)
                        Width: =Parent.Width - 120
                        X: =12
                        Y: =8
                        ZIndex: =1

                    lbl_DimensionAvg As label:
                        Align: =Align.Right
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Bold
                        Size: =14
                        Text: =If(!IsBlank(ThisItem.AvgScore), Text(ThisItem.AvgScore, "0.0"), "-") & "  (" & Text(ThisItem.Count) & ")"
                        Width: =100
                        X: =Parent.Width - 112
                        Y: =8
                    ZIndex: =2

        // Time-based averages (Monthly or Quarterly) and attachments viewer
        cntr_TimeAndAttachments As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            FillPortions: =0
            Height: =Parent.Height - cntr_KPIRow.Height - cntr_BreakdownRow.Height - 40
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =20
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =10
            Width: =Parent.Width - 40
            X: =20
            Y: =cntr_BreakdownRow.Y + cntr_BreakdownRow.Height + 10
            ZIndex: =4

            // Period breakdown list (acts like a lightweight chart source)
            cntr_PeriodBreakdown As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =2
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =1

                lbl_Period_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Average Overall Score by Period"
                    ZIndex: =1

                glry_AvgByPeriod As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =
                        With(
                            {
                                base: Filter(
                                    gblAssessView,
                                    (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                                    (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value) &&
                                    'Status '.Value = "Completed" && !IsBlank(OverallScore)
                                )
                            },
                            If(
                                drp_Granularity.Selected.Value = "Monthly",
                                With(
                                    { m: AddColumns(base, "MonthNum", Month(AssessmentDate), "MonthLabel", Text(AssessmentDate, "[$-en-US]mmm")) },
                                    AddColumns(
                                        SortByColumns(
                                            GroupBy(m, "MonthNum", "Rows"),
                                            "MonthNum",
                                            Ascending
                                        ),
                                        "Label", LookUp(m, MonthNum = ThisRecord.MonthNum).MonthLabel,
                                        "AvgScore", Average(Rows, OverallScore),
                                        "Count", CountRows(Rows)
                                    )
                                ),
                                With(
                                    { q: AddColumns(base, "QuarterNum", RoundUp(Month(AssessmentDate)/3, 0)) },
                                    AddColumns(
                                        SortByColumns(
                                            GroupBy(q, "QuarterNum", "Rows"),
                                            "QuarterNum",
                                            Ascending
                                        ),
                                        "Label", "Q" & Text(QuarterNum),
                                        "AvgScore", Average(Rows, OverallScore),
                                        "Count", CountRows(Rows)
                                    )
                                )
                            )
                        )
                    Layout: =Layout.Vertical
                    TemplateSize: =40
                    ZIndex: =2

                // Column chart rendering for period averages
                glry_AvgByPeriodChart As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =glry_AvgByPeriod.AllItems
                    Layout: =Layout.Horizontal
                    TemplateSize: =60
                    ZIndex: =3

                    shp_Col As rectangle:
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Fill: =App.Theme.Colors.Primary
                        Height: =Max(2, (Parent.TemplateHeight-24) * (ThisItem.AvgScore/5))
                        Width: =24
                        X: =18
                        Y: =Parent.TemplateHeight - Self.Height - 8
                        ZIndex: =1

                    lbl_ColLabel As label:
                        Align: =Align.Center
                        Color: =RGBA(137, 137, 137, 1)
                        Font: =App.Theme.Font
                        Size: =10
                        Text: =ThisItem.Label
                        Width: =Parent.TemplateWidth
                        X: =0
                        Y: =Parent.TemplateHeight - 18
                        ZIndex: =2

                    lbl_PeriodLabel As label:
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        Text: =ThisItem.Label
                        Width: =100
                        X: =12
                        Y: =6
                        ZIndex: =1

                    lbl_PeriodAvg As label:
                        Align: =Align.Right
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Bold
                        Size: =14
                        Text: =Text(ThisItem.AvgScore, "0.00") & "  (" & Text(ThisItem.Count) & ")"
                        Width: =120
                        X: =Parent.Width - 132
                        Y: =6
                        ZIndex: =2

            // Attachments for selected assessment
            cntr_Attachments As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =1
                DropShadow: =DropShadow.Light
                FillPortions: =1
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                ZIndex: =2

                lbl_Attach_Title As label:
                    Color: =RGBA(137, 137, 137, 1)
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =12
                    Size: =13
                    Text: ="Attachments (select assessment)"
                    ZIndex: =1

                glry_AssessmentsForAttach As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =Filter(
                        gblAssessView,
                        (drp_ReportVertical.Selected.Value = "All" || Vertical.Value = drp_ReportVertical.Selected.Value) &&
                        (IsBlank(drp_Year.Selected.Value) || Year(AssessmentDate) = drp_Year.Selected.Value)
                    )
                    Layout: =Layout.Vertical
                    TemplateSize: =40
                    ZIndex: =2

                    btn_AssessmentPick As Button:
                        Appearance: ='ButtonCanvas.Appearance'.Subtle
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        OnSelect: =UpdateContext({ ctxSelectedAssessment: ThisItem })
                        Text: =Coalesce(ThisItem.Title, "Assessment " & Text(ThisItem.ID)) & "  (" & Text(ThisItem.AssessmentDate, "[$-en-US]yyyy-mm-dd") & ")"
                        Width: =Parent.Width - 24
                        X: =12
                        Y: =4
                        ZIndex: =1

                glry_Attachments As gallery.variableTemplateHeightGallery:
                    BorderColor: =RGBA(230, 230, 230, 1)
                    DelayItemLoading: =true
                    FillPortions: =1
                    Items: =If(!IsBlank(ctxSelectedAssessment), ctxSelectedAssessment.'{Attachments}', Table())
                    Layout: =Layout.Vertical
                    TemplateSize: =36
                    ZIndex: =3

                    lbl_AttName As label:
                        Color: =RGBA(0, 0, 0, 1)
                        Font: =App.Theme.Font
                        Size: =12
                        Text: =ThisItem.DisplayName
                        Width: =Parent.Width - 110
                        X: =12
                        Y: =6
                        ZIndex: =1

                    btn_OpenAttach As Button:
                        Appearance: ='ButtonCanvas.Appearance'.Subtle
                        DisplayMode: =DisplayMode.Edit
                        Height: =24
                        OnSelect: =Launch(ThisItem.Value)
                        Text: ="Open"
                        Width: =80
                        X: =Parent.Width - 92
                        Y: =6
                        ZIndex: =2



